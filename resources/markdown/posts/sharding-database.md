---
Image: https://muath.algharabli.com/imgs/blog/posts/sharding/sharding-database.png
Title: "كل ما تحتاج معرفته عن Sharding قواعد البيانات"
Description: "شرح مفصل لتقنية Sharding في قواعد البيانات، فوائدها، أنواعها مع أمثلة عملية خاصة بلغة PHP Laravel."
Published at: 2025-04-26
Categories: databases, backend
---

## مقدمة

مع نمو حجم البيانات وكثرة المستخدمين، تصبح قاعدة البيانات التقليدية عبئًا على أداء النظام، مما يؤدي إلى بطء الاستعلامات وزيادة الأحمال. هنا تظهر أهمية تقنية **Sharding** كحل فعال لتوزيع البيانات بطريقة ذكية.

في هذه المقالة، سنغوص في مفهوم الـ **Sharding**، نناقش فوائده، أنواعه، ونقدّم أمثلة عملية باستخدام **PHP Laravel**.

---

## ما هو الـ Sharding؟

**Sharding** هو عملية تقسيم قاعدة البيانات الكبيرة إلى عدة قواعد بيانات أصغر مستقلة تُسمى "شظايا" (Shards)، حيث يتم توزيع البيانات بينها بطريقة تجعل كل خادم يتعامل مع جزء فقط من البيانات.

كل Shard يحتوي على مجموعة فرعية من البيانات ولا يحتاج إلى معرفة جميع البيانات الموجودة في باقي الشظايا.

---

## أهمية الـ Sharding ولماذا تحتاجه؟

- **تحسين الأداء:** بدلاً من تحميل قاعدة بيانات واحدة بجميع الطلبات، يتم توزيع الحمل على عدة خوادم.
- **زيادة التوسع الأفقي (Horizontal Scaling):** يمكنك إضافة المزيد من الخوادم بسهولة عندما يزيد حجم البيانات.
- **تقليل نقاط الفشل:** عطل خادم واحد لا يؤثر على النظام بالكامل.
- **تحسين زمن استجابة الاستعلامات (Query Latency):** بسبب تقليل كمية البيانات التي يجب التعامل معها.

---

## أنواع الشاردينغ مع أمثلة

(نفس الأمثلة السابقة حول Key-Based, Range-Based, Geographic Sharding)

---

## كيفية تطبيق Sharding باستخدام PHP Laravel

### خطوات عامة:
1. إعداد عدة اتصالات بقاعدة البيانات في ملف `config/database.php`.
2. تحديد أي اتصال سيتم استخدامه حسب منطق الشاردينغ في كود التطبيق.
3. استخدام الاتصال الصحيح عند تنفيذ الاستعلامات.

---

### 1. إعداد عدة اتصالات بقاعدة البيانات

<div dir="ltr">

```php
// config/database.php

'connections' => [
    'shard1' => [
        'driver' => 'mysql',
        'host' => env('DB_SHARD1_HOST'),
        'database' => env('DB_SHARD1_DATABASE'),
        'username' => env('DB_SHARD1_USERNAME'),
        'password' => env('DB_SHARD1_PASSWORD'),
    ],
    'shard2' => [
        'driver' => 'mysql',
        'host' => env('DB_SHARD2_HOST'),
        'database' => env('DB_SHARD2_DATABASE'),
        'username' => env('DB_SHARD2_USERNAME'),
        'password' => env('DB_SHARD2_PASSWORD'),
    ],
]
```
</div>

---

### 2. تحديد الاتصال بناءً على منطق الشاردينغ

<div dir="ltr">

```php
// تحديد الاتصال المناسب داخل كود التطبيق بناءً على user_id
function getShardConnection($userId) {
    if ($userId <= 10000) {
        return 'shard1';
    } else {
        return 'shard2';
    }
}

// مثال عملي
$userId = Auth::id();
$connectionName = getShardConnection($userId);
```
</div>

---

### 3. تنفيذ الاستعلام باستخدام الاتصال المناسب

<div dir="ltr">

```php
// تنفيذ الاستعلام بناءً على الاتصال المناسب
$orders = DB::connection($connectionName)->table('orders')->where('user_id', $userId)->get();
```

</div>

---

## الخلاصة

تقنية الـ Sharding أصبحت ضرورية مع تزايد أحجام البيانات، وهي تساهم بشكل فعال في تحسين أداء التطبيقات وضمان قابلية التوسع.

ومع قوة Laravel ومرونته في إدارة الاتصالات، يمكنك بناء نظام شاردينغ احترافي بسهولة عند الحاجة.

تذكّر:
- لا تستخدم Sharding مبكرًا بدون حاجة حقيقية.
- خطط لتصميم الشاردينغ بحكمة لضمان سهولة إدارة النظام مستقبلاً.

هل سبق وأن طبقت Sharding في مشروعك باستخدام Laravel؟ شاركنا تجربتك في التعليقات!

---
